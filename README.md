# variant-scorer
The variant scoring repository provides a set of scripts for scoring genetic variants using a ChromBPNet model. 

**variant_scoring.py** - This script takes a list of variants in various input formats and generates scores for the variants using a ChromBPNet model. The output is a TSV file containing the scores for each variant. 

### Usage:

python variant_scoring.py -l [VARIANTS_FILE] -g [GENOME_FASTA] -m [MODEL_PATH] -o [OUT_PREFIX] -s [CHROM_SIZES] [OTHER_ARGS]

````

## Input arguments:

-l or --list: (required) a TSV file containing the list of variants to score.

-g or --genome: (required) a genome fasta file.

-pg or --peak_genome: a genome fasta file for peaks.

-m or --model: (required) the ChromBPNet model to use for variant scoring. For most use cases, this should be the bias-corrected model (chrombpnet_nobias.h5)

-o or --out_prefix: (required) the path to store SNP effect score predictions from the script. The directory should already exist.

-s or --chrom_sizes: (required) the path to a TSV file with chromosome sizes.

-ps or --peak_chrom_sizes: the path to a TSV file with chromosome sizes for the peak genome.

-dm or --debug_mode: subsample 10000 variants for debug

-bs or --batch_size: the batch size to use for the model. Default is 512.

-sc or --schema: the format for the input variants list. Choices are: 'bed', 'plink', 'chrombpnet', 'original'. Default is 'chrombpnet'.

-p or --peaks: a bed file containing peak regions.

-n or --num_shuf: the number of shuffled scores per SNP. Default is 10.

-t or --total_shuf: the total number of shuffled scores across all SNPs. Overrides --num_shuf.

-c or --chrom: only score SNPs in the selected chromosome.

-r or --random_seed: the random seed for reproducibility when sampling. Default is 1234.

--no_hdf5: do not save detailed predictions in hdf5 file.

-fo or --forward_only: run variant scoring only on forward sequence.

-st or --shap_type: the type of SHAP values to compute. Default is "counts".

````

### Supported Variant List Schemas:

* chrombpnet : ['chr', 'pos', 'allele1', 'allele2', 'rsid']
* bed : ['chr', 'pos', 'end', 'allele1', 'allele2', 'rsid']
* plink : ['chr', 'rsid', 'ignore1', 'pos', 'allele1', 'allele2']
* original : ['chr', 'pos', 'rsid', 'allele1', 'allele2']

---

**variant_summary_across_folds.py** - This script takes variant scores generated by the variant_scoring.py script and generates a summary file for each score type. The output is a TSV file containing summary statistics for each score type. 

### Usage:
python variant_summary_across_folds.py -s [VARIANT_SCORE_PATH] -o [out_prefix] -p [PEAKS] -g [GENES] -s [SCHEMA] -sl [SCORE_LIST]

````

## Input arguments:
-s or --score_path (required): The directory contains variant scores that will be used to generate summary

-o or --out_prefix (required): Path to storing the summary file average across folds, directory should already exist

-sl or --score_list: (required): A list of TSV files contrains variant score

-p or --peaks (required): a bed file containing peak regions.

-g or --genes: (required): A bed file with gene coordinates

-sc or --schema: the format for the input variants list. Choices are: 'bed', 'plink', 'chrombpnet', 'original'. Default is 'chrombpnet'.

````

---

**Note:** pos (position) column is for 1-indexed SNP position.
